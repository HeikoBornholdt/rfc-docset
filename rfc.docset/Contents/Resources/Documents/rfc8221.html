<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index,follow" name="robots"/>
<meta content="rfchandler version 0.2" name="creator"/>
<meta content="P. Wouters" name="citation_author"/>
<meta content="D. Migault" name="citation_author"/>
<meta content="J. Mattsson" name="citation_author"/>
<meta content="Y. Nir" name="citation_author"/>
<meta content="T. Kivinen" name="citation_author"/>
<meta content="October, 2017" name="citation_publication_date"/>
<meta content="Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)" name="citation_title"/>
<meta content="10.17487/RFC8221" name="citation_doi"/>
<meta content="2070-1721" name="citation_issn"/>
<meta content="rfc8221" name="citation_technical_report_number"/>
<meta content="https://www.rfc-editor.org/rfc/pdfrfc/rfc8221.txt.pdf" name="citation_pdf_url"/>
<title>RFC 8221: Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)</title>
<style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
           /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
<!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script></head>
<body>
<span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href="/rfc/rfc8221.txt">TEXT</a>|<a href="/rfc/pdfrfc/rfc8221.txt.pdf">PDF</a>|<a href="/rfc/rfc8221.html">HTML</a>] [<a href="https://datatracker.ietf.org/doc/rfc8221" title="IETF Datatracker information for this document">Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=8221&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/info/rfc8221" title="Info page">Info page</a>]                  </span><br/><span class="pre noprint docinfo"> </span><br/><span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/><span class="pre noprint docinfo"> </span><pre>Internet Engineering Task Force (IETF)                        P. Wouters
Request for Comments: 8221                                       Red Hat
Obsoletes: <a href="./rfc7321.html">7321</a>                                               D. Migault
Category: Standards Track                                    J. Mattsson
ISSN: 2070-1721                                                 Ericsson
                                                                  Y. Nir
                                                             Check Point
                                                              T. Kivinen
                                                            October 2017


 <span class="h1">Cryptographic Algorithm Implementation Requirements and Usage Guidance</span>
for Encapsulating Security Payload (ESP) and Authentication Header (AH)

Abstract

   This document replaces <a href="./rfc7321.html">RFC 7321</a>, "Cryptographic Algorithm
   Implementation Requirements and Usage Guidance for Encapsulating
   Security Payload (ESP) and Authentication Header (AH)".  The goal of
   this document is to enable ESP and AH to benefit from cryptography
   that is up to date while making IPsec interoperable.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841.html#section-2">SectionÂ 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8221">https://www.rfc-editor.org/info/rfc8221</a>.
















<span class="grey">Wouters, et al.              Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     1.1.  Updating Algorithm Implementation Requirements and Usage
           Guidance  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Updating Algorithm Requirement Levels . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.3">1.3</a>.  Document Audience . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Requirements Language . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  Manual Keying . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  Encryption Must Be Authenticated  . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  ESP Encryption Algorithms . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  ESP and AH Authentication Algorithms  . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-7">7</a>.  ESP and AH Compression Algorithms . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-8">8</a>.  Summary of Changes from <a href="./rfc7321.html">RFC 7321</a>  . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-9">9</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-10">10</a>. Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-11">11</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-11.1">11.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-11.2">11.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>















<span class="grey">Wouters, et al.              Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Encapsulating Security Payload (ESP) [<a href="./rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] and the
   Authentication Header (AH) [<a href="./rfc4302.html" title='"IP Authentication Header"'>RFC4302</a>] are the mechanisms for applying
   cryptographic protection to data being sent over an IPsec Security
   Association (SA) [<a href="./rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>].

   This document provides guidance and recommendations so that ESP and
   AH can be used with cryptographic algorithms that are up to date.
   The challenge of such documents is making sure that, over time, IPsec
   implementations can use secure and up-to-date cryptographic
   algorithms while keeping IPsec interoperable.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.1.%20%20Updating%20Algorithm%20Implementation%20Requirements%20and%20Usage%20Guidance"></a></body></html><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Updating Algorithm Implementation Requirements and Usage Guidance</span>

   The field of cryptography evolves continuously: new, stronger
   algorithms appear, and existing algorithms are found to be less
   secure than originally thought.  Therefore, algorithm implementation
   requirements and usage guidance need to be updated from time to time
   to reflect the new reality.  The choices for algorithms must be
   conservative to minimize the risk of algorithm compromise.
   Algorithms need to be suitable for a wide variety of CPU
   architectures and device deployments ranging from high-end bulk
   encryption devices to small, low-power Internet of Things (IoT)
   devices.

   The algorithm implementation requirements and usage guidance may need
   to change over time to adapt to the changing world.  For this reason,
   the selection of mandatory-to-implement algorithms was removed from
   the main Internet Key Exchange Protocol Version 2 (IKEv2)
   specification [<a href="./rfc7296.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC7296</a>] and placed in a separate document.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.2.%20%20Updating%20Algorithm%20Requirement%20Levels"></a></body></html><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Updating Algorithm Requirement Levels</span>

   The mandatory-to-implement algorithm of tomorrow should already be
   available in most implementations of AH/ESP by the time it is made
   mandatory.  This document attempts to identify and introduce those
   algorithms for future mandatory-to-implement status.  There is no
   guarantee that the algorithms in use today may become mandatory in
   the future.  Published algorithms are continuously subjected to
   cryptographic attack and may become too weak or could become
   completely broken before this document is updated.

   This document only provides recommendations for the mandatory-to-
   implement algorithms and "too weak" algorithms that are recommended
   not to be implemented.  As a result, any algorithm listed at the
   IPsec IANA registry that is not mentioned in this document <em>MAY</em> be
   implemented.  It is expected that this document will be updated over



<span class="grey">Wouters, et al.              Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   time and future versions will only mention algorithms that have
   evolved in status.  For clarification, when an algorithm has been
   mentioned in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>], this document states explicitly the update of
   the status.

   Although this document updates the algorithms to keep the AH/ESP
   communication secure over time, it also aims at providing
   recommendations so that AH/ESP implementations remain interoperable.
   AH/ESP interoperability is addressed by an incremental introduction
   or deprecation of algorithms.  In addition, this document also
   considers the new use cases for AH/ESP deployment, such as IoT.

   It is expected that deprecation of an algorithm be performed
   gradually.  This provides time for various implementations to update
   their implemented algorithms while remaining interoperable.  Unless
   there are strong security reasons, an algorithm is expected to be
   downgraded from <em>MUST</em> to <em>MUST</em>- or <em>SHOULD</em>, instead of <em>MUST NOT</em> (see
   <a href="#section-2">Section 2</a>).  Similarly, an algorithm that has not been mentioned as
   mandatory-to-implement is expected to be introduced with a <em>SHOULD</em>
   instead of a <em>MUST</em>.

   The current trend toward IoT and its adoption of AH/ESP requires this
   specific use case to be taken into account as well.  IoT devices are
   resource-constrained devices, and their choice of algorithms is
   motivated by minimizing the footprint of the code, the computation
   effort, and the size of the messages to send.  This document
   indicates "(IoT)" when a specified algorithm is specifically listed
   for IoT devices.  Requirement levels that are marked as "IoT" apply
   to IoT devices and to server-side implementations that might
   presumably need to interoperate with them, including any general-
   purpose VPN gateways.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.3.%20%20Document%20Audience"></a></body></html><a class="selflink" href="#section-1.3" id="section-1.3">1.3</a>.  Document Audience</span>

   The recommendations of this document mostly target AH/ESP
   implementers as implementations need to meet both high security
   expectations as well as high interoperability between various vendors
   and with different versions.  Interoperability requires a smooth move
   to more secure cipher suites.  This may differ from a user point of
   view that may deploy and configure AH/ESP with only the safest cipher
   suite.

   This document does not give any recommendations for the use of
   algorithms, it only gives recommendations for implementations.  The
   use of algorithms by a specific user is dictated by their own
   security policy requirements, which are outside the scope of this
   document.




<span class="grey">Wouters, et al.              Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   The algorithms considered here are listed by IANA as part of the
   IKEv2 parameters.  IKEv1 is out of scope of this document.  IKEv1 is
   deprecated; the recommendations of this document must not be
   considered for IKEv1, nor may IKEv1 parameters be considered by this
   document.

   The IANA registry for "Internet Key Exchange Version 2 (IKEv2)
   Parameters" contains some entries that are not for use with ESP or
   AH.  This document does not modify the status of those algorithms.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Requirements%20Language"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Requirements Language</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in
   <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a> [<a href="./rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="./rfc8174.html" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

   We define some additional terms here:

   <em>SHOULD</em>+   This term means the same as <em>SHOULD</em>.  However, it is likely
             that an algorithm marked as <em>SHOULD</em>+ will be promoted at
             some future time to be a <em>MUST</em>.
   <em>SHOULD</em>-   This term means the same as <em>SHOULD</em>.  However, an algorithm
             marked as <em>SHOULD</em>- may be deprecated to a <em>MAY</em> in a future
             version of this document.
   <em>MUST</em>-     This term means the same as <em>MUST</em>.  However, we expect at
             some point that this algorithm will no longer be a <em>MUST</em> in
             a future document.  Although its status will be determined
             at a later time, it is reasonable to expect that if a
             future revision of a document alters the status of a <em>MUST</em>-
             algorithm, it will remain at least a <em>SHOULD</em> or a <em>SHOULD</em>-
             level.
   IoT       The Internet of Things.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Manual%20Keying"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Manual Keying</span>

   Manual keying <em>SHOULD NOT</em> be used, as it is inherently dangerous.
   Without any secure keying protocol, such as IKE, IPsec does not offer
   Perfect Forward Secrecy (PFS) protection; there is no entity to
   ensure the refreshing of session keys, the tracking of Security
   Parameter Index (SPI) uniqueness, and the single use of nonces,
   Initialization Vectors (IVs), and counters.  This document was
   written for deploying ESP/AH using IKE [<a href="./rfc7296.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC7296</a>] and assumes that
   keying happens using IKEv2 or higher.






<span class="grey">Wouters, et al.              Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   If manual keying is used regardless, Counter Mode algorithms such as
   ENCR_AES_CTR, ENCR_AES_CCM, ENCR_AES_GCM, and ENCR_CHACHA20_POLY1305
   <em>MUST NOT</em> be used, as it is incompatible with a secure and persistent
   handling of the counter (as explained in the Security Considerations
   section of [<a href="./rfc3686.html" title='"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"'>RFC3686</a>]).  This particularly applies to IoT devices that
   have no state across reboots.  At the time of writing, ENCR_AES_CBC
   is the only mandatory-to-implement encryption algorithm suitable for
   manual keying.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20Encryption%20Must%20Be%20Authenticated"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  Encryption Must Be Authenticated</span>

   Encryption without authentication is not effective and <em>MUST NOT</em> be
   used.  IPsec offers three ways to provide both encryption and
   authentication:

   o  ESP with an Authenticated Encryption with Associated Data (AEAD)
      cipher

   o  ESP with a non-AEAD cipher + authentication

   o  ESP with a non-AEAD cipher + AH with authentication

   The fastest and most modern method is to use ESP with a combined mode
   cipher, such as an AEAD cipher, that handles encryption/decryption
   and authentication in a single step.  In this case, the AEAD cipher
   is set as the encryption algorithm, and the authentication algorithm
   is set to none.  Examples of this are ENCR_AES_GCM_16 and
   ENCR_CHACHA20_POLY1305.

   A more traditional approach is to use ESP with an encryption and an
   authentication algorithm.  This approach is slower, as the data has
   to be processed twice: once for encryption/decryption and once for
   authentication.  An example of this is ENCR_AES_CBC combined with
   AUTH_HMAC_SHA2_512_256.

   The last method that can be used is ESP+AH.  This method is NOT
   <em>RECOMMENDED</em>.  It is the slowest method and also takes up more octets
   due to the double header of ESP+AH.  This results in a smaller
   effective MTU for the encrypted data.  With this method, ESP is only
   used for confidentiality without an authentication algorithm, and a
   second IPsec protocol of type AH is used for authentication.  An
   example of this is ESP with ENCR_AES_CBC with AH with
   AUTH_HMAC_SHA2_512_256.








<span class="grey">Wouters, et al.              Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20ESP%20Encryption%20Algorithms"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  ESP Encryption Algorithms</span>

    +-------------------------+------------+---------+----------------+
    | Name                    | Status     | AEAD    | Comment        |
    +-------------------------+------------+---------+----------------+
    | ENCR_DES_IV64           | <em>MUST NOT</em>   | No      | UNSPECIFIED    |
    | ENCR_DES                | <em>MUST NOT</em>   | No      | [<a href="./rfc2405.html" title='"The ESP DES-CBC Cipher Algorithm With Explicit IV"'>RFC2405</a>]      |
    | ENCR_3DES               | <em>SHOULD NOT</em> | No      | [<a href="./rfc2451.html" title='"The ESP CBC-Mode Cipher Algorithms"'>RFC2451</a>]      |
    | ENCR_BLOWFISH           | <em>MUST NOT</em>   | No      | [<a href="./rfc2451.html" title='"The ESP CBC-Mode Cipher Algorithms"'>RFC2451</a>]      |
    | ENCR_3IDEA              | <em>MUST NOT</em>   | No      | UNSPECIFIED    |
    | ENCR_DES_IV32           | <em>MUST NOT</em>   | No      | UNSPECIFIED    |
    | ENCR_NULL               | <em>MUST</em>       | No      | [<a href="./rfc2410.html" title='"The NULL Encryption Algorithm and Its Use With IPsec"'>RFC2410</a>]      |
    | ENCR_AES_CBC            | <em>MUST</em>       | No      | [<a href="./rfc3602.html" title='"The AES-CBC Cipher Algorithm and Its Use with IPsec"'>RFC3602</a>][1]   |
    | ENCR_AES_CCM_8          | <em>SHOULD</em>     | Yes     | [<a href="./rfc4309.html" title='"Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)"'>RFC4309</a>](IoT) |
    | ENCR_AES_GCM_16         | <em>MUST</em>       | Yes     | [<a href="./rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>][1]   |
    | ENCR_CHACHA20_POLY1305  | <em>SHOULD</em>     | Yes     | [<a href="./rfc7634.html" title='"ChaCha20, Poly1305, and Their Use in the Internet Key Exchange Protocol (IKE) and IPsec"'>RFC7634</a>]      |
    +-------------------------+------------+---------+----------------+

   [<a id="ref-1">1</a>] - This requirement level is for 128-bit and 256-bit keys. 192-bit
   keys remain at the <em>MAY</em> level.

   (IoT) - This requirement is for interoperability with IoT.  Only
   128-bit keys are at the given level.

   IPsec sessions may have very long lifetime and carry multiple
   packets, so there is a need to move to 256-bit keys in the long term.
   For that purpose, the requirement level for 128-bit keys and 256-bit
   keys is <em>MUST</em> (when applicable).  In that sense, the status for
   256-bit keys has been raised from <em>MAY</em> in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>] to <em>MUST</em>.

   IANA has allocated codes for cryptographic algorithms that have not
   been specified by the IETF.  Such algorithms are noted as
   UNSPECIFIED.  Usually, the use of these algorithms is limited to
   specific cases, and the absence of specification makes
   interoperability difficult for IPsec communications.  These
   algorithms were not mentioned in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>], and this document
   clarifies that such algorithms <em>MUST NOT</em> be implemented for IPsec
   communications.

   Similarly, IANA also allocated code points for algorithms that are
   not expected to be used to secure IPsec communications.  Such
   algorithms are noted as non-IPsec.  As a result, these algorithms
   <em>MUST NOT</em> be implemented.

   Various ciphers that are older, not well tested, and never widely
   implemented have been changed to <em>MUST NOT</em>.





<span class="grey">Wouters, et al.              Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   ENCR_3DES status has been downgraded from <em>MAY</em> in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>] to <em>SHOULD</em>
   NOT.  ENCR_CHACHA20_POLY1305 is a more modern approach and
   alternative for ENCR_3DES than ENCR_AES_CBC, and so it is expected to
   be favored to replace ENCR_3DES.

   ENCR_BLOWFISH has been downgraded to <em>MUST NOT</em> as it has been
   deprecated for years by TWOFISH, which is not standardized for ESP
   and therefore not listed in this document.  Some implementations
   support TWOFISH using a private range number.

   ENCR_NULL status was set to <em>MUST</em> in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>] and remains a <em>MUST</em> to
   enable the use of ESP with only authentication, which is preferred
   over AH due to NAT traversal.  ENCR_NULL is expected to remain <em>MUST</em>
   by protocol requirements.

   ENCR_AES_CBC status remains at <em>MUST</em>.  ENCR_AES_CBC <em>MUST</em> be
   implemented in order to enable interoperability between
   implementations that followed [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>].  However, there is a trend
   for the industry to move to AEAD encryption, and the overhead of
   ENCR_AES_CBC remains quite large, so it is expected to be replaced by
   AEAD algorithms in the long term.

   ENCR_AES_CCM_8 status was set to <em>MAY</em> in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>] and has been raised
   from <em>MAY</em> to <em>SHOULD</em> in order to interact with IoT devices.  As this
   case is not a general use case for VPNs, its status is expected to
   remain as <em>SHOULD</em>.

   ENCR_AES_GCM_16 status has been updated from <em>SHOULD</em>+ to <em>MUST</em> in order
   to favor the use of authenticated encryption and AEAD algorithms.
   ENCR_AES_GCM_16 has been widely implemented for ESP due to its
   increased performance and key longevity compared to ENCR_AES_CBC.

   ENCR_CHACHA20_POLY1305 was not ready to be considered at the time of
   [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>].  It has been recommended by the Crypto Forum Research
   Group (CFRG) and others as an alternative to AES-CBC and AES-GCM.  At
   the time of writing, there are not enough ESP implementations of
   ENCR_CHACHA20_POLY1305 to be able to introduce it at the <em>SHOULD</em>+
   level.  Its status has been set to <em>SHOULD</em> and is expected to become
   <em>MUST</em> in the long term.












<span class="grey">Wouters, et al.              Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20ESP%20and%20AH%20Authentication%20Algorithms"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  ESP and AH Authentication Algorithms</span>

   Authentication algorithm recommendations in this section are
   targeting two types of communications:

   o  Authenticated-only communications without encryption, such as ESP
      with NULL encryption or AH communications.

   o  Communications that are encrypted with a non-AEAD algorithm that
      <em>MUST</em> be combined with an authentication algorithm.

   +------------------------+----------------+-------------------------+
   | Name                   | Status         | Comment                 |
   +------------------------+----------------+-------------------------+
   | AUTH_NONE              | <em>MUST</em> /         | [<a href="./rfc7296.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC7296</a>][RFC5282]      |
   |                        | <em>MUST NOT</em>       | AEAD-only               |
   | AUTH_HMAC_MD5_96       | <em>MUST NOT</em>       | [<a href="./rfc2403.html" title='"The Use of HMAC-MD5-96 within ESP and AH"'>RFC2403</a>][RFC7296]      |
   | AUTH_HMAC_SHA1_96      | <em>MUST</em>-          | [<a href="./rfc2404.html" title='"The Use of HMAC-SHA-1-96 within ESP and AH"'>RFC2404</a>][RFC7296]      |
   | AUTH_DES_MAC           | <em>MUST NOT</em>       | UNSPECIFIED             |
   | AUTH_KPDK_MD5          | <em>MUST NOT</em>       | UNSPECIFIED             |
   | AUTH_AES_XCBC_96       | <em>SHOULD</em> / <em>MAY</em>   | [<a href="./rfc3566.html" title='"The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec"'>RFC3566</a>][RFC7296]      |
   |                        |                | (IoT)                   |
   | AUTH_AES_128_GMAC      | <em>MAY</em>            | [<a href="./rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>]               |
   | AUTH_AES_256_GMAC      | <em>MAY</em>            | [<a href="./rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>]               |
   | AUTH_HMAC_SHA2_256_128 | <em>MUST</em>           | [<a href="./rfc4868.html" title='"Using HMAC-SHA-256, HMAC-SHA- 384, and HMAC-SHA-512 with IPsec"'>RFC4868</a>]               |
   | AUTH_HMAC_SHA2_512_256 | <em>SHOULD</em>         | [<a href="./rfc4868.html" title='"Using HMAC-SHA-256, HMAC-SHA- 384, and HMAC-SHA-512 with IPsec"'>RFC4868</a>]               |
   +------------------------+----------------+-------------------------+

   (IoT) - This requirement is for interoperability with IoT.

   AUTH_NONE has been downgraded from <em>MAY</em> in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>] to <em>MUST NOT</em>.  The
   only case where AUTH_NONE is acceptable is when authenticated
   encryption algorithms are selected from <a href="#section-5">Section 5</a>.  In all other
   cases, AUTH_NONE <em>MUST NOT</em> be selected.  As ESP and AH both provide
   authentication, one may be tempted to combine these protocols to
   provide authentication.  As mentioned by [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>], it is NOT
   <em>RECOMMENDED</em> to use ESP with NULL authentication (with non-
   authenticated encryption) in conjunction with AH; some configurations
   of this combination of services have been shown to be insecure
   [<a href="#ref-PD10" title='"On the (in)security of IPsec in MAC-then-encrypt configurations"'>PD10</a>].  In addition, AUTH_NONE authentication cannot be combined
   with ESP NULL encryption.

   AUTH_HMAC_MD5_96 and AUTH_KPDK_MD5 were not mentioned in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>].
   As MD5 is known to be vulnerable to collisions, these algorithms <em>MUST</em>
   NOT be used.

   AUTH_HMAC_SHA1_96 has been downgraded from <em>MUST</em> in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>] to <em>MUST</em>-
   as there is an industry-wide trend to deprecate its usage.



<span class="grey">Wouters, et al.              Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   AUTH_DES_MAC was not mentioned in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>].  As DES is known to be
   vulnerable, it <em>MUST NOT</em> be used.

   AUTH_AES_XCBC_96 is set as <em>SHOULD</em> only in the scope of IoT, as IoT
   deployments tend to prefer AES-based Hashed Message Authentication
   Code (HMAC) functions in order to avoid implementing SHA2.  For the
   wide VPN deployment, as it has not been widely adopted, it has been
   downgraded from <em>SHOULD</em> to <em>MAY</em>.

   AUTH_AES_128_GMAC status has been downgraded from <em>SHOULD</em>+ to <em>MAY</em>.
   Along with AUTH_AES_192_GMAC and AUTH_AES_256_GMAC, these algorithms
   should only be used for AH and not for ESP.  If using ENCR_NULL,
   AUTH_HMAC_SHA2_256_128 is recommended for integrity.  If using AES-
   GMAC in ESP without authentication, ENCR_NULL_AUTH_AES_GMAC is
   recommended.  Therefore, these algorithms are kept at <em>MAY</em>.

   AUTH_HMAC_SHA2_256_128 was not mentioned in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>], as no
   SHA2-based authentication was mentioned.  AUTH_HMAC_SHA2_256_128 <em>MUST</em>
   be implemented in order to replace AUTH_HMAC_SHA1_96.  Note that due
   to a long standing common implementation bug of this algorithm that
   truncates the hash at 96 bits instead of 128 bits, it is recommended
   that implementations prefer AUTH_HMAC_SHA2_512_256 over
   AUTH_HMAC_SHA2_256_128 if they implement AUTH_HMAC_SHA2_512_256.

   AUTH_HMAC_SHA2_512_256 <em>SHOULD</em> be implemented as a future replacement
   of AUTH_HMAC_SHA2_256_128 or when stronger security is required.
   This value has been preferred to AUTH_HMAC_SHA2_384, as the
   additional overhead of AUTH_HMAC_SHA2_512 is negligible.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20ESP%20and%20AH%20Compression%20Algorithms"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  ESP and AH Compression Algorithms</span>

                +----------------+----------+-------------+
                | Name           | Status   | Comment     |
                +----------------+----------+-------------+
                | IPCOMP_OUI     | <em>MUST NOT</em> | UNSPECIFIED |
                | IPCOMP_DEFLATE | <em>MAY</em>      | [<a href="./rfc3173.html" title='"IP Payload Compression Protocol (IPComp)"'>RFC3173</a>]   |
                | IPCOMP_LZS     | <em>MAY</em>      | [<a href="./rfc2395.html" title='"IP Payload Compression Using LZS"'>RFC2395</a>]   |
                | IPCOMP_LZJH    | <em>MAY</em>      | [<a href="./rfc3051.html" title='"IP Payload Compression Using ITU-T V.44 Packet Method"'>RFC3051</a>]   |
                +----------------+----------+-------------+

   Compression was not mentioned in [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>].  As it is not widely
   deployed, it remains optional and at the <em>MAY</em> level.









<span class="grey">Wouters, et al.              Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.%20%20Summary%20of%20Changes%20from%20RFC%207321"></a></body></html><a class="selflink" href="#section-8" id="section-8">8</a>.  Summary of Changes from <a href="./rfc7321.html">RFC 7321</a></span>

   The following table summarizes the changes from <a href="./rfc7321.html">RFC 7321</a>.

            +-------------------+----------+-----------------+
            | Algorithm         | <a href="./rfc7321.html">RFC 7321</a> |     <a href="./rfc8221.html">RFC 8221</a>    |
            +-------------------+----------+-----------------+
            | ENCR_AES_GCM_16   | <em>SHOULD</em>+  |       <em>MUST</em>      |
            | ENCR_AES_CCM_8    |   <em>MAY</em>    |      <em>SHOULD</em>     |
            | ENCR_AES_CTR      |   <em>MAY</em>    |      <em>MAY</em>(*)     |
            | ENCR_3DES         |   <em>MAY</em>    |    <em>SHOULD NOT</em>   |
            | AUTH_HMAC_SHA1_96 |   <em>MUST</em>   |      <em>MUST</em>-      |
            | AUTH_AES_128_GMAC | <em>SHOULD</em>+  |       <em>MAY</em>       |
            | AUTH_NONE         |   <em>MAY</em>    | <em>MUST</em> / <em>MUST NOT</em> |
            +-------------------+----------+-----------------+

   (*) This algorithm is not mentioned in the above sections, so it
   defaults to <em>MAY</em>.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-9" id="section-9">9</a>.  IANA Considerations</span>

   This document does not require any IANA actions.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-10" id="section-10">10</a>.  Security Considerations</span>

   The security of a system that uses cryptography depends on both the
   strength of the cryptographic algorithms chosen and the strength of
   the keys used with those algorithms.  The security also depends on
   the engineering and administration of the protocol used by the system
   to ensure that there are no non-cryptographic ways to bypass the
   security of the overall system.

   This document concerns itself with the selection of cryptographic
   algorithms for the use of ESP and AH, specifically with the selection
   of mandatory-to-implement algorithms.  The algorithms identified in
   this document as "<em>MUST</em> implement" or "<em>SHOULD</em> implement" are not known
   to be broken at the current time, and cryptographic research to date
   leads us to believe that they will likely remain secure into the
   foreseeable future.  However, this is not necessarily forever.
   Therefore, we expect that revisions of that document will be issued
   from time to time to reflect the current best practice in this area.










<span class="grey">Wouters, et al.              Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.%20%20References"></a></body></html><a class="selflink" href="#section-11" id="section-11">11</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-11.1" id="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="./rfc4301.html">RFC 4301</a>, DOI 10.17487/RFC4301,
              December 2005, &lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;.

   [<a id="ref-RFC4302">RFC4302</a>]  Kent, S., "IP Authentication Header", <a href="./rfc4302.html">RFC 4302</a>,
              DOI 10.17487/RFC4302, December 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4302">https://www.rfc-editor.org/info/rfc4302</a>&gt;.

   [<a id="ref-RFC4303">RFC4303</a>]  Kent, S., "IP Encapsulating Security Payload (ESP)",
              <a href="./rfc4303.html">RFC 4303</a>, DOI 10.17487/RFC4303, December 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;.

   [<a id="ref-RFC7321">RFC7321</a>]  McGrew, D. and P. Hoffman, "Cryptographic Algorithm
              Implementation Requirements and Usage Guidance for
              Encapsulating Security Payload (ESP) and Authentication
              Header (AH)", <a href="./rfc7321.html">RFC 7321</a>, DOI 10.17487/RFC7321, August 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7321">https://www.rfc-editor.org/info/rfc7321</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="./rfc2119.html">RFC</a>
              <a href="./rfc2119.html">2119</a> Key Words", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-11.2" id="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-PD10">PD10</a>]     Paterson, K. and J. Degabriele, "On the (in)security of
              IPsec in MAC-then-encrypt configurations", Proceedings of
              the 17th ACM Conference on Computer and Communications
              Security (ACM CCS), DOI 10.1145/1866307.1866363, 2010.

   [<a id="ref-RFC2395">RFC2395</a>]  Friend, R. and R. Monsour, "IP Payload Compression Using
              LZS", <a href="./rfc2395.html">RFC 2395</a>, DOI 10.17487/RFC2395, December 1998,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2395">https://www.rfc-editor.org/info/rfc2395</a>&gt;.

   [<a id="ref-RFC2403">RFC2403</a>]  Madson, C. and R. Glenn, "The Use of HMAC-MD5-96 within
              ESP and AH", <a href="./rfc2403.html">RFC 2403</a>, DOI 10.17487/RFC2403, November
              1998, &lt;<a href="https://www.rfc-editor.org/info/rfc2403">https://www.rfc-editor.org/info/rfc2403</a>&gt;.






<span class="grey">Wouters, et al.              Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   [<a id="ref-RFC2404">RFC2404</a>]  Madson, C. and R. Glenn, "The Use of HMAC-SHA-1-96 within
              ESP and AH", <a href="./rfc2404.html">RFC 2404</a>, DOI 10.17487/RFC2404, November
              1998, &lt;<a href="https://www.rfc-editor.org/info/rfc2404">https://www.rfc-editor.org/info/rfc2404</a>&gt;.

   [<a id="ref-RFC2405">RFC2405</a>]  Madson, C. and N. Doraswamy, "The ESP DES-CBC Cipher
              Algorithm With Explicit IV", <a href="./rfc2405.html">RFC 2405</a>,
              DOI 10.17487/RFC2405, November 1998,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2405">https://www.rfc-editor.org/info/rfc2405</a>&gt;.

   [<a id="ref-RFC2410">RFC2410</a>]  Glenn, R. and S. Kent, "The NULL Encryption Algorithm and
              Its Use With IPsec", <a href="./rfc2410.html">RFC 2410</a>, DOI 10.17487/RFC2410,
              November 1998, &lt;<a href="https://www.rfc-editor.org/info/rfc2410">https://www.rfc-editor.org/info/rfc2410</a>&gt;.

   [<a id="ref-RFC2451">RFC2451</a>]  Pereira, R. and R. Adams, "The ESP CBC-Mode Cipher
              Algorithms", <a href="./rfc2451.html">RFC 2451</a>, DOI 10.17487/RFC2451, November
              1998, &lt;<a href="https://www.rfc-editor.org/info/rfc2451">https://www.rfc-editor.org/info/rfc2451</a>&gt;.

   [<a id="ref-RFC3051">RFC3051</a>]  Heath, J. and J. Border, "IP Payload Compression Using
              ITU-T V.44 Packet Method", <a href="./rfc3051.html">RFC 3051</a>, DOI 10.17487/RFC3051,
              January 2001, &lt;<a href="https://www.rfc-editor.org/info/rfc3051">https://www.rfc-editor.org/info/rfc3051</a>&gt;.

   [<a id="ref-RFC3173">RFC3173</a>]  Shacham, A., Monsour, B., Pereira, R., and M. Thomas, "IP
              Payload Compression Protocol (IPComp)", <a href="./rfc3173.html">RFC 3173</a>,
              DOI 10.17487/RFC3173, September 2001,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3173">https://www.rfc-editor.org/info/rfc3173</a>&gt;.

   [<a id="ref-RFC3566">RFC3566</a>]  Frankel, S. and H. Herbert, "The AES-XCBC-MAC-96 Algorithm
              and Its Use With IPsec", <a href="./rfc3566.html">RFC 3566</a>, DOI 10.17487/RFC3566,
              September 2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3566">https://www.rfc-editor.org/info/rfc3566</a>&gt;.

   [<a id="ref-RFC3602">RFC3602</a>]  Frankel, S., Glenn, R., and S. Kelly, "The AES-CBC Cipher
              Algorithm and Its Use with IPsec", <a href="./rfc3602.html">RFC 3602</a>,
              DOI 10.17487/RFC3602, September 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3602">https://www.rfc-editor.org/info/rfc3602</a>&gt;.

   [<a id="ref-RFC3686">RFC3686</a>]  Housley, R., "Using Advanced Encryption Standard (AES)
              Counter Mode With IPsec Encapsulating Security Payload
              (ESP)", <a href="./rfc3686.html">RFC 3686</a>, DOI 10.17487/RFC3686, January 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;.

   [<a id="ref-RFC4106">RFC4106</a>]  Viega, J. and D. McGrew, "The Use of Galois/Counter Mode
              (GCM) in IPsec Encapsulating Security Payload (ESP)",
              <a href="./rfc4106.html">RFC 4106</a>, DOI 10.17487/RFC4106, June 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4106">https://www.rfc-editor.org/info/rfc4106</a>&gt;.







<span class="grey">Wouters, et al.              Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


   [<a id="ref-RFC4309">RFC4309</a>]  Housley, R., "Using Advanced Encryption Standard (AES) CCM
              Mode with IPsec Encapsulating Security Payload (ESP)",
              <a href="./rfc4309.html">RFC 4309</a>, DOI 10.17487/RFC4309, December 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4309">https://www.rfc-editor.org/info/rfc4309</a>&gt;.

   [<a id="ref-RFC4543">RFC4543</a>]  McGrew, D. and J. Viega, "The Use of Galois Message
              Authentication Code (GMAC) in IPsec ESP and AH", <a href="./rfc4543.html">RFC 4543</a>,
              DOI 10.17487/RFC4543, May 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4543">https://www.rfc-editor.org/info/rfc4543</a>&gt;.

   [<a id="ref-RFC4868">RFC4868</a>]  Kelly, S. and S. Frankel, "Using HMAC-SHA-256, HMAC-SHA-
              384, and HMAC-SHA-512 with IPsec", <a href="./rfc4868.html">RFC 4868</a>,
              DOI 10.17487/RFC4868, May 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;.

   [<a id="ref-RFC5282">RFC5282</a>]  Black, D. and D. McGrew, "Using Authenticated Encryption
              Algorithms with the Encrypted Payload of the Internet Key
              Exchange version 2 (IKEv2) Protocol", <a href="./rfc5282.html">RFC 5282</a>,
              DOI 10.17487/RFC5282, August 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5282">https://www.rfc-editor.org/info/rfc5282</a>&gt;.

   [<a id="ref-RFC7296">RFC7296</a>]  Kaufman, C., Hoffman, P., Nir, Y., Eronen, P., and T.
              Kivinen, "Internet Key Exchange Protocol Version 2
              (IKEv2)", STD 79, <a href="./rfc7296.html">RFC 7296</a>, DOI 10.17487/RFC7296, October
              2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;.

   [<a id="ref-RFC7634">RFC7634</a>]  Nir, Y., "ChaCha20, Poly1305, and Their Use in the
              Internet Key Exchange Protocol (IKE) and IPsec", <a href="./rfc7634.html">RFC 7634</a>,
              DOI 10.17487/RFC7634, August 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7634">https://www.rfc-editor.org/info/rfc7634</a>&gt;.





















<span class="grey">Wouters, et al.              Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc8221.html">RFC 8221</a>            ESP and AH Algorithm Requirements       October 2017</span>


Acknowledgements

   Some of the wording in this document was adapted from [<a href="./rfc7321.html" title='"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"'>RFC7321</a>], the
   document that this one obsoletes, which was written by D. McGrew and
   P. Hoffman.

Authors' Addresses

   Paul Wouters
   Red Hat

   Email: pwouters@redhat.com

   Daniel Migault
   Ericsson
   8275 Trans Canada Route
   Saint-Laurent, QC  H4S 0B6
   Canada

   Phone: +1 514-452-2160
   Email: daniel.migault@ericsson.com


   John Mattsson
   Ericsson AB
   SE-164 80 Stockholm
   Sweden

   Email: john.mattsson@ericsson.com


   Yoav Nir
   Check Point Software Technologies Ltd.
   5 Hasolelim St.
   Tel Aviv  6789735
   Israel

   Email: ynir.ietf@gmail.com


   Tero Kivinen

   Email: kivinen@iki.fi








Wouters, et al.              Standards Track                   [Page 15]
</pre>
</body>
</html>
