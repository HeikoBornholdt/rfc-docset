<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index,follow" name="robots"/>
<meta content="rfchandler version 0.2" name="creator"/>
<meta content="A. Popov" name="citation_author"/>
<meta content="February, 2015" name="citation_publication_date"/>
<meta content="Prohibiting RC4 Cipher Suites" name="citation_title"/>
<meta content="10.17487/RFC7465" name="citation_doi"/>
<meta content="2070-1721" name="citation_issn"/>
<meta content="rfc7465" name="citation_technical_report_number"/>
<meta content="https://www.rfc-editor.org/rfc/pdfrfc/rfc7465.txt.pdf" name="citation_pdf_url"/>
<title>RFC 7465: Prohibiting RC4 Cipher Suites</title>
<style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
           /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
<!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script></head>
<body>
<span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href="/rfc/rfc7465.txt">TEXT</a>|<a href="/rfc/pdfrfc/rfc7465.txt.pdf">PDF</a>|<a href="/rfc/rfc7465.html">HTML</a>] [<a href="https://datatracker.ietf.org/doc/rfc7465" title="IETF Datatracker information for this document">Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7465&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/info/rfc7465" title="Info page">Info page</a>]                  </span><br/><span class="pre noprint docinfo"> </span><br/><span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/><span class="pre noprint docinfo">Updated by: <a href="/rfc/rfc8996" target="_blank">8996</a> </span><pre>Internet Engineering Task Force (IETF)                          A. Popov
Request for Comments: 7465                               Microsoft Corp.
Updates: <a href="./rfc5246.html">5246</a>, <a href="./rfc4346.html">4346</a>, <a href="./rfc2246.html">2246</a>                                  February 2015
Category: Standards Track
ISSN: 2070-1721


                     <span class="h1">Prohibiting RC4 Cipher Suites</span>

Abstract

   This document requires that Transport Layer Security (TLS) clients
   and servers never negotiate the use of RC4 cipher suites when they
   establish connections.  This applies to all TLS versions.  This
   document updates RFCs 5246, 4346, and 2246.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7465">http://www.rfc-editor.org/info/rfc7465</a>.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.







<span class="grey">Popov                        Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc7465.html">RFC 7465</a>              Prohibiting RC4 Cipher Suites        February 2015</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Changes to TLS  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-3">3</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-4.1">4.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-4.2">4.2</a>.  Informative References  . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#appendix-A">Appendix A</a>.  RC4 Cipher Suites  . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   RC4 is a stream cipher that is described in [<a href="#ref-SCH" title='"Applied Cryptography: Protocols, Algorithms, and Source Code in C"'>SCH</a>]; it is widely
   supported, and often preferred by TLS servers.  However, RC4 has long
   been known to have a variety of cryptographic weaknesses, e.g., see
   [<a href="#ref-PAU" title='"Permutation after RC4 Key Scheduling Reveals the Secret Key"'>PAU</a>], [<a href="#ref-MAN" title='"A Practical Attack on Broadcast RC4"'>MAN</a>], and [<a href="#ref-FLU" title='"Weaknesses in the Key Scheduling Algorithm of RC4"'>FLU</a>].  Recent cryptanalysis results [<a href="#ref-ALF" title='"On the Security of RC4 in TLS and WPA"'>ALF</a>] exploit
   biases in the RC4 keystream to recover repeatedly encrypted
   plaintexts.

   These recent results are on the verge of becoming practically
   exploitable; currently, they require 2^26 sessions or 13x2^30
   encryptions.  As a result, RC4 can no longer be seen as providing a
   sufficient level of security for TLS sessions.

   This document requires that TLS ([<a href="./rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] [<a href="./rfc4346.html" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>RFC4346</a>] [<a href="./rfc2246.html" title='"The TLS Protocol Version 1.0"'>RFC2246</a>])
   clients and servers never negotiate the use of RC4 cipher suites.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.1.%20%20Requirements%20Language"></a></body></html><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "<em>MAY</em>", and "<em>OPTIONAL</em>" in this
   document are to be interpreted as described in [<a href="./rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Changes%20to%20TLS"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Changes to TLS</span>

   Because of the RC4 deficiencies noted in <a href="#section-1">Section 1</a>, the following
   apply:

   o  TLS clients <em>MUST NOT</em> include RC4 cipher suites in the ClientHello
      message.

   o  TLS servers <em>MUST NOT</em> select an RC4 cipher suite when a TLS client
      sends such a cipher suite in the ClientHello message.





<span class="grey">Popov                        Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc7465.html">RFC 7465</a>              Prohibiting RC4 Cipher Suites        February 2015</span>


   o  If the TLS client only offers RC4 cipher suites, the TLS server
      <em>MUST</em> terminate the handshake.  The TLS server <em>MAY</em> send the
      insufficient_security fatal alert in this case.

   <a href="#appendix-A">Appendix A</a> lists the RC4 cipher suites defined for TLS.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Security Considerations</span>

   This document helps maintain the security guarantees of the TLS
   protocol by prohibiting the use of the RC4-based cipher suites
   (listed in <a href="#appendix-A">Appendix A</a>), which do not provide a sufficiently high
   level of security.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20References"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119.html">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2246">RFC2246</a>]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              <a href="./rfc2246.html">RFC 2246</a>, January 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2246">http://www.rfc-editor.org/info/rfc2246</a>&gt;.

   [<a id="ref-RFC4346">RFC4346</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", <a href="./rfc4346.html">RFC 4346</a>, April 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4346">http://www.rfc-editor.org/info/rfc4346</a>&gt;.

   [<a id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="./rfc5246.html">RFC 5246</a>, August 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Informative References</span>

   [<a id="ref-ALF">ALF</a>]      AlFardan, N., Bernstein, D., Paterson, K., Poettering, B.,
              and J. Schuldt, "On the Security of RC4 in TLS and WPA",
              USENIX Security Symposium, July 2013,
              &lt;<a href="https://www.usenix.org/conference/usenixsecurity13/security-rc4-tls">https://www.usenix.org/conference/usenixsecurity13/</a>
              <a href="https://www.usenix.org/conference/usenixsecurity13/security-rc4-tls">security-rc4-tls</a>&gt;.

   [<a id="ref-FLU">FLU</a>]      Fluhrer, S., Mantin, I., and A. Shamir, "Weaknesses in the
              Key Scheduling Algorithm of RC4", Selected Areas of
              Cryptography: SAC 2001, Lecture Notes in Computer Science
              Vol. 2259, pp 1-24, 2001.






<span class="grey">Popov                        Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc7465.html">RFC 7465</a>              Prohibiting RC4 Cipher Suites        February 2015</span>


   [<a id="ref-MAN">MAN</a>]      Mantin, I. and A. Shamir, "A Practical Attack on Broadcast
              RC4", Fast Software Encryption: FSE 2001, Lecture Notes in
              Computer Science Vol. 2355, pp 152-164, 2002.

   [<a id="ref-PAU">PAU</a>]      Paul, G. and S. Maitra, "Permutation after RC4 Key
              Scheduling Reveals the Secret Key", Selected Areas of
              Cryptography: SAC 2007, Lecture Notes on Computer Science,
              Vol. 4876, pp 360-337, 2007.

   [<a id="ref-SCH">SCH</a>]      Schneier, B., "Applied Cryptography: Protocols,
              Algorithms, and Source Code in C", 2nd Edition, 1996.








































<span class="grey">Popov                        Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc7465.html">RFC 7465</a>              Prohibiting RC4 Cipher Suites        February 2015</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20A.%20%20RC4%20Cipher%20Suites"></a></body></html><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  RC4 Cipher Suites</span>

   The following cipher suites defined for TLS use RC4:

   o  TLS_RSA_EXPORT_WITH_RC4_40_MD5

   o  TLS_RSA_WITH_RC4_128_MD5

   o  TLS_RSA_WITH_RC4_128_SHA

   o  TLS_DH_anon_EXPORT_WITH_RC4_40_MD5

   o  TLS_DH_anon_WITH_RC4_128_MD5

   o  TLS_KRB5_WITH_RC4_128_SHA

   o  TLS_KRB5_WITH_RC4_128_MD5

   o  TLS_KRB5_EXPORT_WITH_RC4_40_SHA

   o  TLS_KRB5_EXPORT_WITH_RC4_40_MD5

   o  TLS_PSK_WITH_RC4_128_SHA

   o  TLS_DHE_PSK_WITH_RC4_128_SHA

   o  TLS_RSA_PSK_WITH_RC4_128_SHA

   o  TLS_ECDH_ECDSA_WITH_RC4_128_SHA

   o  TLS_ECDHE_ECDSA_WITH_RC4_128_SHA

   o  TLS_ECDH_RSA_WITH_RC4_128_SHA

   o  TLS_ECDHE_RSA_WITH_RC4_128_SHA

   o  TLS_ECDH_anon_WITH_RC4_128_SHA

   o  TLS_ECDHE_PSK_WITH_RC4_128_SHA












<span class="grey">Popov                        Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc7465.html">RFC 7465</a>              Prohibiting RC4 Cipher Suites        February 2015</span>


Acknowledgements

   This document was inspired by discussions with Magnus Nystrom, Eric
   Rescorla, Joseph Salowey, Yaron Sheffer, Nagendra Modadugu, and
   others on the TLS mailing list.

Author's Address

   Andrei Popov
   Microsoft Corp.
   One Microsoft Way
   Redmond, WA  98052
   USA

   EMail: andreipo@microsoft.com




































Popov                        Standards Track                    [Page 6]
</pre>
</body>
</html>
