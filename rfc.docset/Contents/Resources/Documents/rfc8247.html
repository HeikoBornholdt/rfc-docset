<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index,follow" name="robots"/>
<meta content="rfchandler version 0.2" name="creator"/>
<meta content="Y. Nir" name="citation_author"/>
<meta content="T. Kivinen" name="citation_author"/>
<meta content="P. Wouters" name="citation_author"/>
<meta content="D. Migault" name="citation_author"/>
<meta content="September, 2017" name="citation_publication_date"/>
<meta content="Algorithm Implementation Requirements and Usage Guidance for the Internet Key Exchange Protocol Version 2 (IKEv2)" name="citation_title"/>
<meta content="10.17487/RFC8247" name="citation_doi"/>
<meta content="2070-1721" name="citation_issn"/>
<meta content="rfc8247" name="citation_technical_report_number"/>
<meta content="https://www.rfc-editor.org/rfc/pdfrfc/rfc8247.txt.pdf" name="citation_pdf_url"/>
<title>RFC 8247: Algorithm Implementation Requirements and Usage Guidance for the Internet Key Exchange Protocol Version 2 (IKEv2)</title>
<style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
           /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
<!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script></head>
<body>
<span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href="/rfc/rfc8247.txt">TEXT</a>|<a href="/rfc/pdfrfc/rfc8247.txt.pdf">PDF</a>|<a href="/rfc/rfc8247.html">HTML</a>] [<a href="https://datatracker.ietf.org/doc/rfc8247" title="IETF Datatracker information for this document">Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=8247&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/info/rfc8247" title="Info page">Info page</a>]                  </span><br/><span class="pre noprint docinfo"> </span><br/><span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/><span class="pre noprint docinfo"> </span><pre>Internet Engineering Task Force (IETF)                            Y. Nir
Request for Comments: 8247                                      Dell EMC
Obsoletes: <a href="./rfc4307.html">4307</a>                                               T. Kivinen
Updates: <a href="./rfc7296.html">7296</a>
Category: Standards Track                                     P. Wouters
ISSN: 2070-1721                                                  Red Hat
                                                              D. Migault
                                                                Ericsson
                                                          September 2017


        <span class="h1">Algorithm Implementation Requirements and Usage Guidance</span>
        <span class="h1">for the Internet Key Exchange Protocol Version 2 (IKEv2)</span>

Abstract

   The IPsec series of protocols makes use of various cryptographic
   algorithms in order to provide security services.  The Internet Key
   Exchange (IKE) protocol is used to negotiate the IPsec Security
   Association (IPsec SA) parameters, such as which algorithms should be
   used.  To ensure interoperability between different implementations,
   it is necessary to specify a set of algorithm implementation
   requirements and usage guidance to ensure that there is at least one
   algorithm that all implementations support.  This document updates
   <a href="./rfc7296.html">RFC 7296</a> and obsoletes <a href="./rfc4307.html">RFC 4307</a> in defining the current algorithm
   implementation requirements and usage guidance for IKEv2, and does
   minor cleaning up of the IKEv2 IANA registry.  This document does not
   update the algorithms used for packet encryption using IPsec
   Encapsulating Security Payload (ESP).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8247">https://www.rfc-editor.org/info/rfc8247</a>.








<span class="grey">Nir, et al.                  Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Conventions Used in This Document ..........................<a href="#page-3">3</a>
      1.2. Updating Algorithm Implementation Requirements and
           Usage Guidance .............................................<a href="#page-4">4</a>
      <a href="#section-1.3">1.3</a>. Updating Algorithm Requirement Levels ......................<a href="#page-4">4</a>
      <a href="#section-1.4">1.4</a>. Document Audience ..........................................<a href="#page-5">5</a>
   <a href="#section-2">2</a>. Algorithm Selection .............................................<a href="#page-5">5</a>
      <a href="#section-2.1">2.1</a>. Type 1 - IKEv2 Encryption Algorithm Transforms .............<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. Type 2 - IKEv2 Pseudorandom Function Transforms ............<a href="#page-7">7</a>
      <a href="#section-2.3">2.3</a>. Type 3 - IKEv2 Integrity Algorithm Transforms ..............<a href="#page-8">8</a>
      <a href="#section-2.4">2.4</a>. Type 4 - IKEv2 Diffie-Hellman Group Transforms .............<a href="#page-9">9</a>
      <a href="#section-2.5">2.5</a>. Summary of Changes from <a href="./rfc4307.html">RFC 4307</a> ..........................<a href="#page-11">11</a>
   <a href="#section-3">3</a>. IKEv2 Authentication ...........................................<a href="#page-11">11</a>
      <a href="#section-3.1">3.1</a>. IKEv2 Authentication Method ...............................<a href="#page-12">12</a>
           <a href="#section-3.1.1">3.1.1</a>. Recommendations for RSA Key Length .................<a href="#page-13">13</a>
      <a href="#section-3.2">3.2</a>. Digital Signature Recommendations .........................<a href="#page-13">13</a>
   <a href="#section-4">4</a>. Algorithms for Internet of Things ..............................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-15">15</a>
   <a href="#section-6">6</a>. IANA Considerations ............................................<a href="#page-15">15</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-16">16</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-16">16</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-17">17</a>
   Acknowledgements ..................................................<a href="#page-17">17</a>
   Authors' Addresses ................................................<a href="#page-19">19</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The Internet Key Exchange (IKE) protocol [<a href="./rfc7296.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC7296</a>] is used to
   negotiate the parameters of the IPsec SA, such as the encryption and
   authentication algorithms and the keys for the protected
   communications between the two endpoints.  The IKE protocol itself is



<span class="grey">Nir, et al.                  Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   also protected by cryptographic algorithms, which are negotiated
   between the two endpoints using IKE.  Different implementations of
   IKE may negotiate different algorithms based on their individual
   local policy.  To ensure interoperability, a set of "mandatory-to-
   implement" IKE cryptographic algorithms is defined.

   This document describes the parameters of the IKE protocol and
   updates the IKEv2 specification.  It changes the mandatory-to-
   implement authentication algorithms in <a href="./rfc7296.html#section-4">Section 4 of [RFC7296]</a> by
   saying that RSA key lengths of less than 2048 <em>SHOULD NOT</em> be used.  It
   does not describe the cryptographic parameters of the Authentication
   Header (AH) or ESP protocols.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a></body></html><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in
   <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a> [<a href="./rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="./rfc8174.html" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

   When used in the tables in this document, these terms indicate that
   the listed algorithm <em>MUST</em>, <em>MUST NOT</em>, <em>SHOULD</em>, <em>SHOULD NOT</em>, or <em>MAY</em> be
   implemented as part of an IKEv2 implementation.  Additional terms
   used in this document are:

   <em>SHOULD</em>+   This term means the same as <em>SHOULD</em>.  However, it is likely
             that an algorithm marked as <em>SHOULD</em>+ will be promoted at
             some future time to be a <em>MUST</em>.

   <em>SHOULD</em>-   This term means the same as <em>SHOULD</em>.  However, an algorithm
             marked as <em>SHOULD</em>- may be deprecated to a <em>MAY</em> in a future
             version of this document.

   <em>MUST</em>-     This term means the same as <em>MUST</em>.  However, it is expected
             at some point that this algorithm will no longer be a <em>MUST</em>
             in a future document.  Although its status will be
             determined at a later time, it is reasonable to expect that
             if a future revision of a document alters the status of a
             <em>MUST</em>- algorithm, it will remain at least a <em>SHOULD</em> or a
             <em>SHOULD</em>- level.

   IoT       This abbreviation stands for "Internet of Things".








<span class="grey">Nir, et al.                  Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.2.%20%20Updating%20Algorithm%20Implementation%20Requirements%20and%20Usage%20Guidance"></a></body></html><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Updating Algorithm Implementation Requirements and Usage Guidance</span>

   The field of cryptography evolves continuously.  New, stronger
   algorithms appear and existing algorithms are found to be less secure
   than originally thought.  Therefore, algorithm implementation
   requirements and usage guidance need to be updated from time to time
   to reflect the new reality.  The choices for algorithms must be
   conservative to minimize the risk of algorithm compromise.
   Algorithms need to be suitable for a wide variety of CPU
   architectures and device deployments ranging from high-end bulk
   encryption devices to small low-power IoT devices.

   The algorithm implementation requirements and usage guidance may need
   to change over time to adapt to the changing world.  For this reason,
   the selection of mandatory-to-implement algorithms was removed from
   the main IKEv2 specification and placed in this separate document.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.3.%20%20Updating%20Algorithm%20Requirement%20Levels"></a></body></html><a class="selflink" href="#section-1.3" id="section-1.3">1.3</a>.  Updating Algorithm Requirement Levels</span>

   The mandatory-to-implement algorithm of tomorrow should already be
   available in most implementations of IKE by the time it is made
   mandatory.  This document attempts to identify and introduce those
   algorithms for future mandatory-to-implement status.  There is no
   guarantee that the algorithms in use today may become mandatory in
   the future.  Published algorithms are continuously subjected to
   cryptographic attack and may become too weak or could become
   completely broken before this document is updated.

   This document provides updated recommendations for the mandatory-to-
   implement algorithms.  As a result, any algorithm listed at the IKEv2
   IANA registry not mentioned in this document <em>MAY</em> be implemented.  For
   clarification and consistency with [<a href="./rfc4307.html" title='"Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2)"'>RFC4307</a>], an algorithm will be
   denoted here as <em>MAY</em> only when it has been downgraded.

   Although this document updates the algorithms to keep the IKEv2
   communication secure over time, it also aims at providing
   recommendations so that IKEv2 implementations remain interoperable.
   IKEv2 interoperability is addressed by an incremental introduction or
   deprecation of algorithms.  In addition, this document also considers
   the new use cases for IKEv2 deployment, such as Internet of Things
   (IoT).

   It is expected that deprecation of an algorithm is performed
   gradually.  This provides time for various implementations to update
   their implemented algorithms while remaining interoperable.  Unless
   there are strong security reasons, an algorithm is expected to be
   downgraded from <em>MUST</em> to <em>MUST</em>- or <em>SHOULD</em>, instead of <em>MUST NOT</em>.




<span class="grey">Nir, et al.                  Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   Similarly, an algorithm that has not been mentioned as mandatory-to-
   implement is expected to be introduced with a <em>SHOULD</em> instead of a
   <em>MUST</em>.

   The current trend toward Internet of Things and its adoption of IKEv2
   requires this specific use case to be taken into account as well.
   IoT devices are resource-constrained devices and their choice of
   algorithms are motivated by minimizing the footprint of the code, the
   computation effort, and the size of the messages to send.  This
   document indicates "(IoT)" when a specified algorithm is specifically
   listed for IoT devices.  Requirement levels that are marked as "IoT"
   apply to IoT devices and to server-side implementations that might
   presumably need to interoperate with them, including any general-
   purpose VPN gateways.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.4.%20%20Document%20Audience"></a></body></html><a class="selflink" href="#section-1.4" id="section-1.4">1.4</a>.  Document Audience</span>

   The recommendations of this document mostly target IKEv2 implementers
   who need to create implementations that meet both high security
   expectations as well as high interoperability between various vendors
   and with different versions.  Interoperability requires a smooth move
   to more secure cipher suites.  This may differ from a user point of
   view that may deploy and configure IKEv2 with only the safest cipher
   suite.

   This document does not give any recommendations for the use of
   algorithms, it only gives implementation recommendations regarding
   implementations.  The use of algorithms by a specific user is
   dictated by their own security policy requirements, which are outside
   the scope of this document.

   IKEv1 is out of scope of this document.  IKEv1 is deprecated and the
   recommendations of this document must not be considered for IKEv1, as
   most IKEv1 implementations have been "frozen" and will not be able to
   update the list of mandatory-to-implement algorithms.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Algorithm%20Selection"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Algorithm Selection</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.1.%20%20Type%201%20-%20IKEv2%20Encryption%20Algorithm%20Transforms"></a></body></html><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Type 1 - IKEv2 Encryption Algorithm Transforms</span>

   The algorithms in the table below are negotiated in the Security
   Association (SA) payload and used for the Encrypted Payload.
   References to the specification defining these algorithms and the
   ones in the following subsections are in the IANA registry
   [<a href="#ref-IKEV2-IANA">IKEV2-IANA</a>].  Some of these algorithms are Authenticated Encryption
   with Associated Data (AEAD) [<a href="./rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>].  Algorithms that are not AEAD
   <em>MUST</em> be used in conjunction with one of the integrity algorithms in
   <a href="#section-2.3">Section 2.3</a>.



<span class="grey">Nir, et al.                  Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


          +------------------------+----------+-------+---------+
          | Name                   | Status   | AEAD? | Comment |
          +------------------------+----------+-------+---------+
          | ENCR_AES_CBC           | <em>MUST</em>     | No    | (*)     |
          | ENCR_CHACHA20_POLY1305 | <em>SHOULD</em>   | Yes   |         |
          | ENCR_AES_GCM_16        | <em>SHOULD</em>   | Yes   | (*)     |
          | ENCR_AES_CCM_8         | <em>SHOULD</em>   | Yes   | (IoT)   |
          | ENCR_3DES              | <em>MAY</em>      | No    |         |
          | ENCR_DES               | <em>MUST NOT</em> | No    |         |
          | ENCR_NULL              | <em>MUST NOT</em> | No    |         |
          +------------------------+----------+-------+---------+

   (*)    This requirement level is for 128-bit and 256-bit keys.
          192-bit keys remain at the <em>MAY</em> level.

   (IoT)  This requirement is for interoperability with IoT.  Only
          128-bit keys are at the <em>SHOULD</em> level. 192-bit and 256-bit
          remain at the <em>MAY</em> level.

   ENCR_AES_CBC is raised from <em>SHOULD</em>+ for 128-bit keys and <em>MAY</em> for
   256-bit keys in [<a href="./rfc4307.html" title='"Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2)"'>RFC4307</a>] to <em>MUST</em>. 192-bit keys remain at the <em>MAY</em>
   level.  ENCR_AES_CBC is the only shared mandatory-to-implement
   algorithm with <a href="./rfc4307.html">RFC 4307</a> and as a result, it is necessary for
   interoperability with IKEv2 implementation compatible with <a href="./rfc4307.html">RFC 4307</a>.

   ENCR_CHACHA20_POLY1305 was not ready to be considered at the time of
   <a href="./rfc4307.html">RFC 4307</a>'s publication.  It has been recommended by the Crypto Forum
   Research Group (CFRG) of the IRTF as an alternative to AES-CBC and
   AES-GCM.  It is also being standardized for IPsec for the same
   reasons.  At the time of writing, there were not enough IKEv2
   implementations supporting ENCR_CHACHA20_POLY1305 to be able to
   introduce it at the <em>SHOULD</em>+ level.

   ENCR_AES_GCM_16 was not considered in <a href="./rfc4307.html">RFC 4307</a>.  At the time <a href="./rfc4307.html">RFC 4307</a>
   was written, AES-GCM was not defined in an IETF document.  AES-GCM
   was defined for ESP in [<a href="./rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>] and later for IKEv2 in [<a href="./rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>].
   The main motivation for adopting AES-GCM for ESP is encryption
   performance compared to AES-CBC.  This resulted in AES-GCM being
   widely implemented for ESP.  As the computation load of IKEv2 is
   relatively small compared to ESP, many IKEv2 implementations have not
   implemented AES-GCM.  For this reason, AES-GCM is not promoted to a
   greater status than <em>SHOULD</em>.  The reason for promotion from <em>MAY</em> to
   <em>SHOULD</em> is to promote the slightly more secure AEAD method over the
   traditional encrypt+auth method.  Its status is expected to be raised
   once widely implemented.  As the advantage of the shorter (and
   weaker) Integrity Check Values (ICVs) is minimal, the 8- and 12-octet
   ICVs remain at the <em>MAY</em> level.




<span class="grey">Nir, et al.                  Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   ENCR_AES_CCM_8 was not considered in <a href="./rfc4307.html">RFC 4307</a>.  This document
   considers it as <em>SHOULD</em> be implemented in order to be able to interact
   with IoT devices.  As this case is not a general use case for non-IoT
   VPNs, its status is expected to remain as <em>SHOULD</em>.  The 8-octet size
   of the ICV is expected to be sufficient for most use cases of IKEv2,
   as far less packets are exchanged in those cases, and IoT devices
   want to make packets as small as possible.  The <em>SHOULD</em> level is for
   128-bit keys, 256-bit keys remains at <em>MAY</em> level.

   ENCR_3DES has been downgraded from <a href="./rfc4307.html">RFC 4307</a> <em>MUST</em>- to <em>MAY</em>.  All IKEv2
   implementations already implement ENCR_AES_CBC, so there is no need
   to keep support for the much slower ENCR_3DES.  In addition,
   ENCR_CHACHA20_POLY1305 provides a more modern alternative to AES.

   ENCR_DES can be brute-forced using off-the-shelf hardware.  It
   provides no meaningful security whatsoever and, therefore, <em>MUST NOT</em>
   be implemented.

   ENCR_NULL was incorrectly specified as <em>MAY</em> in <a href="./rfc4307.html">RFC 4307</a>, even when
   <a href="./rfc7296.html#section-5">[RFC7296], Section 5</a> clearly states that it <em>MUST NOT</em> be used.  This
   was fixed and this document now lists ENCR_NULL as <em>MUST NOT</em>.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.%20%20Type%202%20-%20IKEv2%20Pseudorandom%20Function%20Transforms"></a></body></html><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Type 2 - IKEv2 Pseudorandom Function Transforms</span>

   Transform Type 2 algorithms are pseudorandom functions used to
   generate pseudorandom values when needed.

                +-------------------+----------+---------+
                | Name              | Status   | Comment |
                +-------------------+----------+---------+
                | PRF_HMAC_SHA2_256 | <em>MUST</em>     |         |
                | PRF_HMAC_SHA2_512 | <em>SHOULD</em>+  |         |
                | PRF_HMAC_SHA1     | <em>MUST</em>-    |         |
                | PRF_AES128_XCBC   | <em>SHOULD</em>   | (IoT)   |
                | PRF_HMAC_MD5      | <em>MUST NOT</em> |         |
                +-------------------+----------+---------+

         (IoT) This requirement is for interoperability with IoT.

   As no SHA2-based transforms were referenced in <a href="./rfc4307.html">RFC 4307</a>,
   PRF_HMAC_SHA2_256 was not mentioned in <a href="./rfc4307.html">RFC 4307</a>.  PRF_HMAC_SHA2_256
   <em>MUST</em> be implemented in order to replace SHA1 and PRF_HMAC_SHA1.

   PRF_HMAC_SHA2_512 <em>SHOULD</em> be implemented as a future replacement for
   PRF_HMAC_SHA2_256 or when stronger security is required.
   PRF_HMAC_SHA2_512 is preferred over PRF_HMAC_SHA2_384 as the
   additional overhead of PRF_HMAC_SHA2_512 is negligible.




<span class="grey">Nir, et al.                  Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   PRF_HMAC_SHA1 has been downgraded from <em>MUST</em> in <a href="./rfc4307.html">RFC 4307</a> to <em>MUST</em>-, as
   cryptographic attacks against SHA1 are increasing, resulting in an
   industry-wide trend to deprecate its usage.

   PRF_AES128_XCBC is only recommended in the scope of IoT, as Internet
   of Things deployments tend to prefer AES-based pseudorandom functions
   in order to avoid implementing SHA2.  For the non-IoT VPN deployment,
   it has been downgraded from <em>SHOULD</em> in <a href="./rfc4307.html">RFC 4307</a> to <em>MAY</em> as it has not
   seen wide adoption.

   PRF_HMAC_MD5 has been downgraded from <em>MAY</em> in <a href="./rfc4307.html">RFC 4307</a> to <em>MUST NOT</em>.
   Cryptographic attacks against MD5, such as collision attacks
   mentioned in [<a href="#ref-TRANSCRIPTION">TRANSCRIPTION</a>], are resulting in an industry-wide trend
   to deprecate and remove MD5 (and thus HMAC-MD5) from cryptographic
   libraries.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.3.%20%20Type%203%20-%20IKEv2%20Integrity%20Algorithm%20Transforms"></a></body></html><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  Type 3 - IKEv2 Integrity Algorithm Transforms</span>

   The algorithms in the table below are negotiated in the SA payload
   and used for the Encrypted Payload.  References to the specification
   defining these algorithms are in the IANA registry.  When an AEAD
   algorithm (see <a href="#section-2.1">Section 2.1</a>) is proposed, this algorithm transform
   type is not in use.

              +------------------------+----------+---------+
              | Name                   | Status   | Comment |
              +------------------------+----------+---------+
              | AUTH_HMAC_SHA2_256_128 | <em>MUST</em>     |         |
              | AUTH_HMAC_SHA2_512_256 | <em>SHOULD</em>   |         |
              | AUTH_HMAC_SHA1_96      | <em>MUST</em>-    |         |
              | AUTH_AES_XCBC_96       | <em>SHOULD</em>   | (IoT)   |
              | AUTH_HMAC_MD5_96       | <em>MUST NOT</em> |         |
              | AUTH_DES_MAC           | <em>MUST NOT</em> |         |
              | AUTH_KPDK_MD5          | <em>MUST NOT</em> |         |
              +------------------------+----------+---------+

         (IoT) This requirement is for interoperability with IoT.

   AUTH_HMAC_SHA2_256_128 was not mentioned in <a href="./rfc4307.html">RFC 4307</a>, as no
   SHA2-based transforms were mentioned.  AUTH_HMAC_SHA2_256_128 <em>MUST</em> be
   implemented in order to replace AUTH_HMAC_SHA1_96.

   AUTH_HMAC_SHA2_512_256 <em>SHOULD</em> be implemented as a future replacement
   of AUTH_HMAC_SHA2_256_128 or when stronger security is required.
   This value has been preferred over AUTH_HMAC_SHA2_384, as the
   additional overhead of AUTH_HMAC_SHA2_512 is negligible.





<span class="grey">Nir, et al.                  Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   AUTH_HMAC_SHA1_96 has been downgraded from <em>MUST</em> in <a href="./rfc4307.html">RFC 4307</a> to <em>MUST</em>-
   as cryptographic attacks against SHA1 are increasing, resulting in an
   industry-wide trend to deprecate its usage.

   AUTH_AES_XCBC_96 is only recommended in the scope of IoT, as Internet
   of Things deployments tend to prefer AES-based pseudorandom functions
   in order to avoid implementing SHA2.  For the non-IoT VPN deployment,
   it has been downgraded from <em>SHOULD</em> in <a href="./rfc4307.html">RFC 4307</a> to <em>MAY</em> as it has not
   been widely adopted.

   AUTH_DES_MAC and AUTH_KPDK_MD5 were not mentioned in <a href="./rfc4307.html">RFC 4307</a>, so
   their default statuses were <em>MAY</em>.  These have been downgraded to <em>MUST</em>
   NOT.  AUTH_HMAC_MD5_96 is also demoted to <em>MUST NOT</em>.  This is because
   there is an industry-wide trend to deprecate DES and MD5.  Note also
   that MD5 support is being removed from cryptographic libraries in
   general because its non-HMAC use is known to be subject to collision
   attacks, for example, as mentioned in [<a href="#ref-TRANSCRIPTION">TRANSCRIPTION</a>].

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.4.%20%20Type%204%20-%20IKEv2%20Diffie-Hellman%20Group%20Transforms"></a></body></html><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  Type 4 - IKEv2 Diffie-Hellman Group Transforms</span>

   There are several Modular Exponential (MODP) groups and several
   Elliptic Curve Cryptography (ECC) groups that are defined for use in
   IKEv2.  These groups are defined in both the base document [<a href="./rfc7296.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC7296</a>]
   and in extension documents and are identified by group number.  Note
   that it is critical to enforce a secure Diffie-Hellman (DH) exchange
   as this exchange provides keys for the session.  If an attacker can
   retrieve one of the private numbers (a or b) and the complementary
   public value (g**b or g**a), then the attacker can compute the secret
   and the keys used and then decrypt the exchange and IPsec SA created
   inside the IKEv2 SA.  Such an attack can be performed off-line on a
   previously recorded communication, years after the communication
   happened.  This differs from attacks that need to be executed during
   the authentication that must be performed online and in near real
   time.

















<span class="grey">Nir, et al.                  Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   +--------+---------------------------------------------+------------+
   | Number | Description                                 | Status     |
   +--------+---------------------------------------------+------------+
   | 14     | 2048-bit MODP Group                         | <em>MUST</em>       |
   | 19     | 256-bit random ECP group                    | <em>SHOULD</em>     |
   | 5      | 1536-bit MODP Group                         | <em>SHOULD NOT</em> |
   | 2      | 1024-bit MODP Group                         | <em>SHOULD NOT</em> |
   | 1      | 768-bit MODP Group                          | <em>MUST NOT</em>   |
   | 22     | 1024-bit MODP Group with 160-bit Prime      | <em>MUST NOT</em>   |
   |        | Order Subgroup                              |            |
   | 23     | 2048-bit MODP Group with 224-bit Prime      | <em>SHOULD NOT</em> |
   |        | Order Subgroup                              |            |
   | 24     | 2048-bit MODP Group with 256-bit Prime      | <em>SHOULD NOT</em> |
   |        | Order Subgroup                              |            |
   +--------+---------------------------------------------+------------+

   Group 14 or the 2048-bit MODP Group is raised from <em>SHOULD</em>+ in
   <a href="./rfc4307.html">RFC 4307</a> to <em>MUST</em> as a replacement for the 1024-bit MODP Group.  Group
   14 is widely implemented and considered secure.

   Group 19 or the 256-bit random ECP group was not specified in
   <a href="./rfc4307.html">RFC 4307</a> as this group was not defined at that time.  Group 19 is
   widely implemented and considered secure and, therefore, has been
   promoted to the <em>SHOULD</em> level.

   Group 5 or the 1536-bit MODP Group has been downgraded from <em>MAY</em> in
   <a href="./rfc4307.html">RFC 4307</a> to <em>SHOULD NOT</em>.  It was specified earlier, but is now
   considered to be vulnerable to being broken within the next few years
   by a nation-state-level attack, so its security margin is considered
   too narrow.

   Group 2 or the 1024-bit MODP Group has been downgraded from <em>MUST</em>- in
   <a href="./rfc4307.html">RFC 4307</a> to <em>SHOULD NOT</em>.  It is known to be weak against sufficiently
   funded attackers using commercially available mass-computing
   resources, so its security margin is considered too narrow.  It is
   expected in the near future to be downgraded to <em>MUST NOT</em>.

   Group 1 or the 768-bit MODP Group was not mentioned in <a href="./rfc4307.html">RFC 4307</a> and
   so its status was <em>MAY</em>.  It can be broken within hours using cheap
   off-the-shelf hardware.  It provides no security whatsoever.  It has,
   therefore, been downgraded to <em>MUST NOT</em>.

   Groups 22, 23, and 24 are MODP groups with Prime Order Subgroups that
   are not safe primes.  The seeds for these groups have not been
   publicly released, resulting in reduced trust in these groups.  These
   groups were proposed as alternatives for groups 2 and 14 but never
   saw wide deployment.  It has been shown that group 22 with 1024-bit
   MODP is too weak and academia have the resources to generate



<span class="grey">Nir, et al.                  Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   malicious values at this size.  This has resulted in group 22 to be
   demoted to <em>MUST NOT</em>.  Groups 23 and 24 have been demoted to <em>SHOULD</em>
   NOT and are expected to be further downgraded in the near future to
   <em>MUST NOT</em>.  Since groups 23 and 24 have small subgroups, the checks
   specified in the first bullet point of <a href="#section-2.2">Section 2.2</a> of "Additional
   Diffie-Hellman Tests for the Internet Key Exchange Protocol Version 2
   (IKEv2)" [<a href="./rfc6989.html" title='"Additional Diffie-Hellman Tests for the Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC6989</a>] <em>MUST</em> be done when these groups are used.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.5.%20%20Summary%20of%20Changes%20from%20RFC%204307"></a></body></html><a class="selflink" href="#section-2.5" id="section-2.5">2.5</a>.  Summary of Changes from <a href="./rfc4307.html">RFC 4307</a></span>

   The following table summarizes the changes from <a href="./rfc4307.html">RFC 4307</a>.

      +---------------------+--------------------------+------------+
      | Algorithm           | <a href="./rfc4307.html">RFC 4307</a>                 | <a href="./rfc8247.html">RFC 8247</a>   |
      +---------------------+--------------------------+------------+
      | ENCR_3DES           | <em>MUST</em>-                    | <em>MAY</em>        |
      | ENCR_NULL           | <em>MUST NOT</em> (per [<a href="#ref-Err1937" title="RFC 4307">Err1937</a>]) | <em>MUST NOT</em>   |
      | ENCR_AES_CBC        | <em>SHOULD</em>+                  | <em>MUST</em>       |
      | ENCR_AES_CTR        | <em>SHOULD</em>                   | <em>MAY</em>(*)     |
      | PRF_HMAC_MD5        | <em>MAY</em>                      | <em>MUST NOT</em>   |
      | PRF_HMAC_SHA1       | <em>MUST</em>                     | <em>MUST</em>-      |
      | PRF_AES128_XCBC     | <em>SHOULD</em>+                  | <em>SHOULD</em>     |
      | AUTH_HMAC_MD5_96    | <em>MAY</em>                      | <em>MUST NOT</em>   |
      | AUTH_HMAC_SHA1_96   | <em>MUST</em>                     | <em>MUST</em>-      |
      | AUTH_AES_XCBC_96    | <em>SHOULD</em>+                  | <em>SHOULD</em>     |
      | Group 2 (1024-bit)  | <em>MUST</em>-                    | <em>SHOULD NOT</em> |
      | Group 14 (2048-bit) | <em>SHOULD</em>+                  | <em>MUST</em>       |
      +---------------------+--------------------------+------------+

   (*)  This algorithm is not mentioned in the above sections, so it
        defaults to <em>MAY</em>.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20IKEv2%20Authentication"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  IKEv2 Authentication</span>

   IKEv2 authentication may involve a signatures verification.
   Signatures may be used to validate a certificate or to check the
   signature of the AUTH value.  Cryptographic recommendations regarding
   certificate validation are out of scope of this document.  What is
   mandatory to implement is provided by the PKIX community.  This
   document is mostly concerned with signature verification and
   generation for the authentication.










<span class="grey">Nir, et al.                  Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.1.%20%20IKEv2%20Authentication%20Method"></a></body></html><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  IKEv2 Authentication Method</span>

      +--------+---------------------------------------+------------+
      | Number | Description                           | Status     |
      +--------+---------------------------------------+------------+
      | 1      | RSA Digital Signature                 | <em>MUST</em>       |
      | 2      | Shared Key Message Integrity Code     | <em>MUST</em>       |
      | 3      | DSS Digital Signature                 | <em>SHOULD NOT</em> |
      | 9      | ECDSA with SHA-256 on the P-256 curve | <em>SHOULD</em>     |
      | 10     | ECDSA with SHA-384 on the P-384 curve | <em>SHOULD</em>     |
      | 11     | ECDSA with SHA-512 on the P-521 curve | <em>SHOULD</em>     |
      | 14     | Digital Signature                     | <em>SHOULD</em>     |
      +--------+---------------------------------------+------------+

   RSA Digital Signature is widely deployed and, therefore, kept for
   interoperability.  It is expected to be downgraded in the future as
   its signatures are based on the older RSASSA-PKCS1-v1.5, which is no
   longer recommended.  RSA authentication, as well as other specific
   authentication methods, are expected to be replaced with the generic
   Digital Signature method of [<a href="./rfc7427.html" title='"Signature Authentication in the Internet Key Exchange Version 2 (IKEv2)"'>RFC7427</a>].

   Shared Key Message Integrity Code is widely deployed and mandatory to
   implement in the IKEv2 in <a href="./rfc7296.html">RFC 7296</a>.  The status remains <em>MUST</em>.

   "DSS Digital Signature" (IANA value 3) signatures are bound to SHA-1
   and have the same level of security as 1024-bit RSA.  They are
   currently at <em>SHOULD NOT</em> and are expected to be downgraded to <em>MUST NOT</em>
   in the future.

   Authentication methods that are based on the Elliptic Curve Digital
   Signature Algorithm (ECDSA) are also expected to be downgraded as
   these do not provide hash function agility.  Instead, ECDSA (like
   RSA) is expected to be performed using the generic Digital Signature
   method.  Its status is <em>SHOULD</em>.

   Digital Signature [<a href="./rfc7427.html" title='"Signature Authentication in the Internet Key Exchange Version 2 (IKEv2)"'>RFC7427</a>] is expected to be promoted as it provides
   hash function, signature format, and algorithm agility.  Its current
   status is <em>SHOULD</em>.













<span class="grey">Nir, et al.                  Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.1.1.%20%20Recommendations%20for%20RSA%20Key%20Length"></a></body></html><a class="selflink" href="#section-3.1.1" id="section-3.1.1">3.1.1</a>.  Recommendations for RSA Key Length</span>

        +-------------------------------------------+------------+
        | Description                               | Status     |
        +-------------------------------------------+------------+
        | RSA with key length 2048                  | <em>MUST</em>       |
        | RSA with key length 3072 and 4096         | <em>SHOULD</em>     |
        | RSA with key length between 2049 and 4095 | <em>MAY</em>        |
        | RSA with key length smaller than 2048     | <em>SHOULD NOT</em> |
        +-------------------------------------------+------------+

   IKEv2 [<a href="./rfc7296.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC7296</a>] mandates support for the RSA keys of the bit size
   1024 or 2048, but key sizes less than 2048 are updated to <em>SHOULD NOT</em>
   as there is an industry-wide trend to deprecate key lengths less than
   2048 bits.  Since these signatures only have value in real time and
   need no future protection, smaller keys were kept at <em>SHOULD NOT</em>
   instead of <em>MUST NOT</em>.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.2.%20%20Digital%20Signature%20Recommendations"></a></body></html><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Digital Signature Recommendations</span>

   When a Digital Signature authentication method is implemented, the
   following recommendations are applied for hash functions:

               +--------+-------------+----------+---------+
               | Number | Description | Status   | Comment |
               +--------+-------------+----------+---------+
               | 1      | SHA1        | <em>MUST NOT</em> |         |
               | 2      | SHA2-256    | <em>MUST</em>     |         |
               | 3      | SHA2-384    | <em>MAY</em>      |         |
               | 4      | SHA2-512    | <em>SHOULD</em>   |         |
               +--------+-------------+----------+---------+

   When the Digital Signature authentication method is used with RSA
   signature algorithm, RSASSA-PSS <em>MUST</em> be supported and RSASSA-
   PKCS1-v1.5 <em>MAY</em> be supported.
















<span class="grey">Nir, et al.                  Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   The following table lists recommendations for authentication methods
   in [<a href="./rfc7427.html" title='"Signature Authentication in the Internet Key Exchange Version 2 (IKEv2)"'>RFC7427</a>] notation.  These recommendations are applied only if the
   Digital Signature authentication method is implemented.

        +------------------------------------+----------+---------+
        | Description                        | Status   | Comment |
        +------------------------------------+----------+---------+
        | RSASSA-PSS with SHA-256            | <em>MUST</em>     |         |
        | ecdsa-with-sha256                  | <em>SHOULD</em>   |         |
        | sha1WithRSAEncryption              | <em>MUST NOT</em> |         |
        | dsa-with-sha1                      | <em>MUST NOT</em> |         |
        | ecdsa-with-sha1                    | <em>MUST NOT</em> |         |
        | RSASSA-PSS with Empty Parameters   | <em>MUST NOT</em> | (*)     |
        | RSASSA-PSS with Default Parameters | <em>MUST NOT</em> | (*)     |
        +------------------------------------+----------+---------+

   (*)  Empty or Default parameters means it is using SHA1, which is at
        the <em>MUST NOT</em> level.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20Algorithms%20for%20Internet%20of%20Things"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  Algorithms for Internet of Things</span>

   Some algorithms in this document are marked for use with the Internet
   of Things (IoT).  There are several reasons why IoT devices prefer a
   different set of algorithms from regular IKEv2 clients.  IoT devices
   are usually very constrained, meaning that the memory size and CPU
   power is so limited that these clients only have resources to
   implement and run one set of algorithms.  For example, instead of
   implementing AES and SHA, these devices typically use AES_XCBC as an
   integrity algorithm so SHA does not need to be implemented.

   For example, IEEE Std 802.15.4 [<a href="#ref-IEEE-802-15-4">IEEE-802-15-4</a>] devices have a
   mandatory-to-implement link-level security using AES-CCM with 128-bit
   keys.  The "IEEE Recommended Practice for Transport of Key Management
   Protocol (KMP) Datagrams" [<a href="#ref-IEEE-802-15-9">IEEE-802-15-9</a>] already provides a way to
   use Minimal IKEv2 [<a href="./rfc7815.html" title='"Minimal Internet Key Exchange Version 2 (IKEv2) Initiator Implementation"'>RFC7815</a>] over the 802.15.4 layer to provide link
   keys for the 802.15.4 layer.

   These devices might want to use AES-CCM as their IKEv2 algorithm, so
   they can reuse the hardware implementing it.  They cannot use the
   AES-CBC algorithm, as the hardware quite often does not include
   support for the AES decryption needed to support the CBC mode.  So
   despite the AES-CCM algorithm requiring AEAD [<a href="./rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>] support, the
   benefit of reusing the crypto hardware makes AES-CCM the preferred
   algorithm.

   Another important aspect of IoT devices is that their transfer rates
   are usually quite low (in the order of tens of kbit/s), and each bit
   they transmit has an energy consumption cost associated with it and



<span class="grey">Nir, et al.                  Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   shortens their battery life.  Therefore, shorter packets are
   preferred.  This is the reason for recommending the 8-octet ICV over
   the 16-octet ICV.

   Because different IoT devices will have different constraints, this
   document cannot specify the one mandatory profile for IoT.  Instead,
   this document points out commonly used algorithms with IoT devices.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Considerations</span>

   The security of cryptographic-based systems depends on both the
   strength of the cryptographic algorithms chosen and the strength of
   the keys used with those algorithms.  The security also depends on
   the engineering of the protocol used by the system to ensure that
   there are no non-cryptographic ways to bypass the security of the
   overall system.

   The Diffie-Hellman Group parameter is the most important one to
   choose conservatively.  Any party capturing all IKE and ESP traffic
   that (even years later) can break the selected DH group in IKE, can
   gain access to the symmetric keys used to encrypt all the ESP
   traffic.  Therefore, these groups must be chosen very conservatively.
   However, specifying an extremely large DH group also puts a
   considerable load on the device, especially when this is a large VPN
   gateway or an IoT-constrained device.

   This document concerns itself with the selection of cryptographic
   algorithms for the use of IKEv2, specifically with the selection of
   "mandatory-to-implement" algorithms.  The algorithms identified in
   this document as "<em>MUST</em> implement" or "<em>SHOULD</em> implement" are not known
   to be broken at the current time, and cryptographic research so far
   leads us to believe that they will likely remain secure into the
   foreseeable future.  However, this isn't necessarily forever and it
   is expected that new revisions of this document will be issued from
   time to time to reflect the current best practice in this area.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  IANA Considerations</span>

   This document renames some of the names in the "Transform Type 1 -
   Encryption Algorithm Transform IDs" registry of the "Internet Key
   Exchange Version 2 (IKEv2) Parameters".  All the other names have
   ENCR_ prefix except 3, and all other entries use names in the format
   of uppercase words separated with underscores except 6.  This
   document changes those names to match others.







<span class="grey">Nir, et al.                  Standards Track                   [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   Per this document, IANA has renamed the following entries for the
   AES-GCM cipher [<a href="./rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>] and the Camellia cipher [<a href="./rfc5529.html" title='"Modes of Operation for Camellia for Use with IPsec"'>RFC5529</a>]:

     +---------------------------------------+----------------------+
     | Old name                              | New name             |
     +---------------------------------------+----------------------+
     | AES-GCM with a 8 octet ICV            | ENCR_AES_GCM_8       |
     | AES-GCM with a 12 octet ICV           | ENCR_AES_GCM_12      |
     | AES-GCM with a 16 octet ICV           | ENCR_AES_GCM_16      |
     | ENCR_CAMELLIA_CCM with an 8-octet ICV | ENCR_CAMELLIA_CCM_8  |
     | ENCR_CAMELLIA_CCM with a 12-octet ICV | ENCR_CAMELLIA_CCM_12 |
     | ENCR_CAMELLIA_CCM with a 16-octet ICV | ENCR_CAMELLIA_CCM_16 |
     +---------------------------------------+----------------------+

   In addition, IANA has added this RFC as a reference to both the ESP
   Reference and IKEv2 Reference columns for ENCR_AES_GCM entries, while
   keeping the existing references there.  Also, IANA has added this RFC
   as a reference to the ESP Reference column for ENCR_CAMELLIA_CCM
   entries, while keeping the existing reference there.

   The registry entries currently are:

   Number Name                  ESP Reference       IKEv2 Reference
   ...
   18     ENCR_AES_GCM_8        [<a href="./rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>][RFC8247]  [<a href="./rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>][RFC8247]
   19     ENCR_AES_GCM_12       [<a href="./rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>][RFC8247]  [<a href="./rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>][RFC8247]
   20     ENCR_AES_GCM_16       [<a href="./rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>][RFC8247]  [<a href="./rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>][RFC8247]
   ...
   25     ENCR_CAMELLIA_CCM_8   [<a href="./rfc5529.html" title='"Modes of Operation for Camellia for Use with IPsec"'>RFC5529</a>][RFC8247]  -
   26     ENCR_CAMELLIA_CCM_12  [<a href="./rfc5529.html" title='"Modes of Operation for Camellia for Use with IPsec"'>RFC5529</a>][RFC8247]  -
   27     ENCR_CAMELLIA_CCM_16  [<a href="./rfc5529.html" title='"Modes of Operation for Camellia for Use with IPsec"'>RFC5529</a>][RFC8247]  -

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20References"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC4106">RFC4106</a>]  Viega, J. and D. McGrew, "The Use of Galois/Counter Mode
              (GCM) in IPsec Encapsulating Security Payload (ESP)",
              <a href="./rfc4106.html">RFC 4106</a>, DOI 10.17487/RFC4106, June 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4106">https://www.rfc-editor.org/info/rfc4106</a>&gt;.






<span class="grey">Nir, et al.                  Standards Track                   [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   [<a id="ref-RFC4307">RFC4307</a>]  Schiller, J., "Cryptographic Algorithms for Use in the
              Internet Key Exchange Version 2 (IKEv2)", <a href="./rfc4307.html">RFC 4307</a>,
              DOI 10.17487/RFC4307, December 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4307">https://www.rfc-editor.org/info/rfc4307</a>&gt;.

   [<a id="ref-RFC5282">RFC5282</a>]  Black, D. and D. McGrew, "Using Authenticated Encryption
              Algorithms with the Encrypted Payload of the Internet Key
              Exchange version 2 (IKEv2) Protocol", <a href="./rfc5282.html">RFC 5282</a>,
              DOI 10.17487/RFC5282, August 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5282">https://www.rfc-editor.org/info/rfc5282</a>&gt;.

   [<a id="ref-RFC7296">RFC7296</a>]  Kaufman, C., Hoffman, P., Nir, Y., Eronen, P., and T.
              Kivinen, "Internet Key Exchange Protocol Version 2
              (IKEv2)", STD 79, <a href="./rfc7296.html">RFC 7296</a>, DOI 10.17487/RFC7296, October
              2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="./rfc2119.html">RFC</a>
              <a href="./rfc2119.html">2119</a> Key Words", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-Err1937">Err1937</a>]  RFC Errata, Erratum ID 1937, <a href="./rfc4307.html">RFC 4307</a>,
              &lt;<a href="https://www.rfc-editor.org/errata/eid1937">https://www.rfc-editor.org/errata/eid1937</a>&gt;.

   [<a id="ref-IEEE-802-15-4">IEEE-802-15-4</a>]
              IEEE, "IEEE Standard for Low-Rate Wireless Personal Area
              Networks (WPANs)", IEEE Standard 802.15.4,
              DOI 10.1109/IEEESTD.2016.7460875, 2015,
              &lt;<a href="http://ieeexplore.ieee.org/document/7460875/">http://ieeexplore.ieee.org/document/7460875/</a>&gt;.

   [<a id="ref-IEEE-802-15-9">IEEE-802-15-9</a>]
              IEEE, "IEEE Recommended Practice for Transport of Key
              Management Protocol (KMP) Datagrams", IEEE Standard
              802.15.9, DOI 10.1109/IEEESTD.2016.7544442, 2016,
              &lt;<a href="http://ieeexplore.ieee.org/document/7544442/">http://ieeexplore.ieee.org/document/7544442/</a>&gt;.

   [<a id="ref-IKEV2-IANA">IKEV2-IANA</a>]
              IANA, "Internet Key Exchange Version 2 (IKEv2)
              Parameters",
              &lt;<a href="http://www.iana.org/assignments/ikev2-parameters">http://www.iana.org/assignments/ikev2-parameters</a>&gt;.

   [<a id="ref-RFC5529">RFC5529</a>]  Kato, A., Kanda, M., and S. Kanno, "Modes of Operation for
              Camellia for Use with IPsec", <a href="./rfc5529.html">RFC 5529</a>,
              DOI 10.17487/RFC5529, April 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5529">https://www.rfc-editor.org/info/rfc5529</a>&gt;.





<span class="grey">Nir, et al.                  Standards Track                   [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


   [<a id="ref-RFC6989">RFC6989</a>]  Sheffer, Y. and S. Fluhrer, "Additional Diffie-Hellman
              Tests for the Internet Key Exchange Protocol Version 2
              (IKEv2)", <a href="./rfc6989.html">RFC 6989</a>, DOI 10.17487/RFC6989, July 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6989">https://www.rfc-editor.org/info/rfc6989</a>&gt;.

   [<a id="ref-RFC7427">RFC7427</a>]  Kivinen, T. and J. Snyder, "Signature Authentication in
              the Internet Key Exchange Version 2 (IKEv2)", <a href="./rfc7427.html">RFC 7427</a>,
              DOI 10.17487/RFC7427, January 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7427">https://www.rfc-editor.org/info/rfc7427</a>&gt;.

   [<a id="ref-RFC7815">RFC7815</a>]  Kivinen, T., "Minimal Internet Key Exchange Version 2
              (IKEv2) Initiator Implementation", <a href="./rfc7815.html">RFC 7815</a>,
              DOI 10.17487/RFC7815, March 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7815">https://www.rfc-editor.org/info/rfc7815</a>&gt;.

   [<a id="ref-TRANSCRIPTION">TRANSCRIPTION</a>]
              Bhargavan, K. and G. Leurent, "Transcript Collision
              Attacks: Breaking Authentication in TLS, IKE, and SSH",
              Network and Distributed System Security Symposium (NDSS),
              DOI 10.14722/ndss.2016.23418, Feb 2016,
              &lt;<a href="https://hal.inria.fr/hal-01244855/">https://hal.inria.fr/hal-01244855/</a>&gt;.

Acknowledgements

   <a href="./rfc4307.html">RFC 4307</a> was authored by Jeffrey I. Schiller of the Massachusetts
   Institute of Technology (MIT).  Much of the original text has been
   copied verbatim.

   We would like to thank Paul Hoffman, Yaron Sheffer, John Mattsson,
   Tommy Pauly, Eric Rescorla, and Pete Resnick for their valuable
   feedback and reviews.




















<span class="grey">Nir, et al.                  Standards Track                   [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc8247.html">RFC 8247</a>             IKEv2 Cryptographic Algorithms       September 2017</span>


Authors' Addresses

   Yoav Nir
   Dell EMC
   9 Andrei Sakharov Street
   Haifa  3190500
   Israel

   Email: ynir.ietf@gmail.com


   Tero Kivinen

   Email: kivinen@iki.fi


   Paul Wouters
   Red Hat

   Email: pwouters@redhat.com


   Daniel Migault
   Ericsson
   8275 Trans Canada Route
   Saint-Laurent, QC  H4S 0B6
   Canada

   Phone: +1 514-452-2160
   Email: daniel.migault@ericsson.com





















Nir, et al.                  Standards Track                   [Page 19]
</pre>
</body>
</html>
